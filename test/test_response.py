import json
import unittest
from unittest import TestCase

from config.configs import RequestType
from response.average_pay import AveragePay
from response.birth_rate import BirthRate
from response.death_rate import DeathRate


class TestResponse(TestCase):

    def test_birth_rate_data(self):
        json_data = '{"class":"dataset","label":"Osnovni podatki o rojenih po: LETO ,  MERITVE","source":"Statistični urad Republike Slovenije","updated":"2006-12-12T09:30:00Z","id":["LETO","MERITVE"],"size":[70,1],"dimension":{"LETO":{"extension":{"show":"value"},"label":"LETO","category":{"index":{"1954":0,"1955":1,"1956":2,"1957":3,"1958":4,"1959":5,"1960":6,"1961":7,"1962":8,"1963":9,"1964":10,"1965":11,"1966":12,"1967":13,"1968":14,"1969":15,"1970":16,"1971":17,"1972":18,"1973":19,"1974":20,"1975":21,"1976":22,"1977":23,"1978":24,"1979":25,"1980":26,"1981":27,"1982":28,"1983":29,"1984":30,"1985":31,"1986":32,"1987":33,"1988":34,"1989":35,"1990":36,"1991":37,"1992":38,"1993":39,"1994":40,"1995":41,"1996":42,"1997":43,"1998":44,"1999":45,"2000":46,"2001":47,"2002":48,"2003":49,"2004":50,"2005":51,"2006":52,"2007":53,"2008":54,"2009":55,"2010":56,"2011":57,"2012":58,"2013":59,"2014":60,"2015":61,"2016":62,"2017":63,"2018":64,"2019":65,"2020":66,"2021":67,"2022":68,"2023":69},"label":{"1954":"1954","1955":"1955","1956":"1956","1957":"1957","1958":"1958","1959":"1959","1960":"1960","1961":"1961","1962":"1962","1963":"1963","1964":"1964","1965":"1965","1966":"1966","1967":"1967","1968":"1968","1969":"1969","1970":"1970","1971":"1971","1972":"1972","1973":"1973","1974":"1974","1975":"1975","1976":"1976","1977":"1977","1978":"1978","1979":"1979","1980":"1980","1981":"1981","1982":"1982","1983":"1983","1984":"1984","1985":"1985","1986":"1986","1987":"1987","1988":"1988","1989":"1989","1990":"1990","1991":"1991","1992":"1992","1993":"1993","1994":"1994","1995":"1995","1996":"1996","1997":"1997","1998":"1998","1999":"1999","2000":"2000","2001":"2001","2002":"2002","2003":"2003","2004":"2004","2005":"2005","2006":"2006","2007":"2007","2008":"2008","2009":"2009","2010":"2010","2011":"2011","2012":"2012","2013":"2013","2014":"2014","2015":"2015","2016":"2016","2017":"2017","2018":"2018","2019":"2019","2020":"2020","2021":"2021","2022":"2022","2023":"2023"}}},"MERITVE":{"extension":{"show":"value"},"label":"MERITVE","category":{"index":{"0":0},"label":{"0":"Živorojeni - SKUPAJ"}}}},"value":[31828,32096,31466,30086,28284,28429,27825,28955,29035,29174,29184,30587,30941,29824,28580,27883,27432,28278,28713,29548,28625,29786,30339,29904,30354,30604,29902,29220,28894,27200,26274,25933,25570,25592,25209,23447,22368,21583,19982,19793,19463,18980,18788,18165,17856,17533,18180,17477,17501,17321,17961,18157,18932,19823,21817,21856,22343,21947,21938,21111,21165,20641,20345,20241,19585,19328,18767,18984,17627,16989],"role":{"time":["LETO"]},"version":"2.0","extension":{"px":{"decimals":0}}}'
        json_load = json.loads(json_data)
        birth_rate = BirthRate(json_load, RequestType.BIRTH_RATE, "metric_key", 200)
        self.method_name1(birth_rate)

    def test_death_rate_data(self):
        json_data = '{"class":"dataset","label":"Osnovni podatki o umrlih po: SPOL, LETO ,  MERITVE","source":"Statistični urad Republike Slovenije","updated":"2005-11-14T09:30:00Z","id":["SPOL","LETO","MERITVE"],"size":[1,70,1],"dimension":{"SPOL":{"extension":{"show":"value"},"label":"SPOL","category":{"index":{"0":0},"label":{"0":"Spol - SKUPAJ"}}},"LETO":{"extension":{"show":"value"},"label":"LETO","category":{"index":{"1954":0,"1955":1,"1956":2,"1957":3,"1958":4,"1959":5,"1960":6,"1961":7,"1962":8,"1963":9,"1964":10,"1965":11,"1966":12,"1967":13,"1968":14,"1969":15,"1970":16,"1971":17,"1972":18,"1973":19,"1974":20,"1975":21,"1976":22,"1977":23,"1978":24,"1979":25,"1980":26,"1981":27,"1982":28,"1983":29,"1984":30,"1985":31,"1986":32,"1987":33,"1988":34,"1989":35,"1990":36,"1991":37,"1992":38,"1993":39,"1994":40,"1995":41,"1996":42,"1997":43,"1998":44,"1999":45,"2000":46,"2001":47,"2002":48,"2003":49,"2004":50,"2005":51,"2006":52,"2007":53,"2008":54,"2009":55,"2010":56,"2011":57,"2012":58,"2013":59,"2014":60,"2015":61,"2016":62,"2017":63,"2018":64,"2019":65,"2020":66,"2021":67,"2022":68,"2023":69},"label":{"1954":"1954","1955":"1955","1956":"1956","1957":"1957","1958":"1958","1959":"1959","1960":"1960","1961":"1961","1962":"1962","1963":"1963","1964":"1964","1965":"1965","1966":"1966","1967":"1967","1968":"1968","1969":"1969","1970":"1970","1971":"1971","1972":"1972","1973":"1973","1974":"1974","1975":"1975","1976":"1976","1977":"1977","1978":"1978","1979":"1979","1980":"1980","1981":"1981","1982":"1982","1983":"1983","1984":"1984","1985":"1985","1986":"1986","1987":"1987","1988":"1988","1989":"1989","1990":"1990","1991":"1991","1992":"1992","1993":"1993","1994":"1994","1995":"1995","1996":"1996","1997":"1997","1998":"1998","1999":"1999","2000":"2000","2001":"2001","2002":"2002","2003":"2003","2004":"2004","2005":"2005","2006":"2006","2007":"2007","2008":"2008","2009":"2009","2010":"2010","2011":"2011","2012":"2012","2013":"2013","2014":"2014","2015":"2015","2016":"2016","2017":"2017","2018":"2018","2019":"2019","2020":"2020","2021":"2021","2022":"2022","2023":"2023"}}},"MERITVE":{"extension":{"show":"value"},"label":"MERITVE","category":{"index":{"1":0},"label":{"1":"Umrli"}}}},"value":[14897,15109,16351,14545,14082,15357,15145,14013,15866,15102,16729,15987,15248,16353,17446,18565,17353,17425,18153,17614,17206,18180,18157,17633,18357,18148,18820,18733,19647,20703,20214,19854,19499,19837,19126,18669,18555,19324,19333,20012,19359,18968,18620,18928,19039,18885,18588,18508,18701,19451,18523,18825,18180,18584,18308,18750,18609,18699,19257,19334,18886,19834,19689,20509,20485,20588,24016,23261,22492,21540],"role":{"time":["LETO"]},"version":"2.0","extension":{"px":{"decimals":0}}}'
        json_load = json.loads(json_data)
        death_rate = DeathRate(json_load, RequestType.BIRTH_RATE, "metric_key", 200)
        self.method_name1(death_rate)

    def test_average_pay_data(self):
        json_data = '{"class":"dataset","label":"Povprečne mesečne plače po: MESEC ,  PLAČE","source":"Statistični urad Republike Slovenije","updated":"2015-03-04T09:30:00Z","id":["MESEC","PLAČE"],"size":[225,1],"dimension":{"MESEC":{"extension":{"show":"value"},"label":"MESEC","category":{"index":{"2006M01":0,"2006M02":1,"2006M03":2,"2006M04":3,"2006M05":4,"2006M06":5,"2006M07":6,"2006M08":7,"2006M09":8,"2006M10":9,"2006M11":10,"2006M12":11,"2007M01":12,"2007M02":13,"2007M03":14,"2007M04":15,"2007M05":16,"2007M06":17,"2007M07":18,"2007M08":19,"2007M09":20,"2007M10":21,"2007M11":22,"2007M12":23,"2008M01":24,"2008M02":25,"2008M03":26,"2008M04":27,"2008M05":28,"2008M06":29,"2008M07":30,"2008M08":31,"2008M09":32,"2008M10":33,"2008M11":34,"2008M12":35,"2009M01":36,"2009M02":37,"2009M03":38,"2009M04":39,"2009M05":40,"2009M06":41,"2009M07":42,"2009M08":43,"2009M09":44,"2009M10":45,"2009M11":46,"2009M12":47,"2010M01":48,"2010M02":49,"2010M03":50,"2010M04":51,"2010M05":52,"2010M06":53,"2010M07":54,"2010M08":55,"2010M09":56,"2010M10":57,"2010M11":58,"2010M12":59,"2011M01":60,"2011M02":61,"2011M03":62,"2011M04":63,"2011M05":64,"2011M06":65,"2011M07":66,"2011M08":67,"2011M09":68,"2011M10":69,"2011M11":70,"2011M12":71,"2012M01":72,"2012M02":73,"2012M03":74,"2012M04":75,"2012M05":76,"2012M06":77,"2012M07":78,"2012M08":79,"2012M09":80,"2012M10":81,"2012M11":82,"2012M12":83,"2013M01":84,"2013M02":85,"2013M03":86,"2013M04":87,"2013M05":88,"2013M06":89,"2013M07":90,"2013M08":91,"2013M09":92,"2013M10":93,"2013M11":94,"2013M12":95,"2014M01":96,"2014M02":97,"2014M03":98,"2014M04":99,"2014M05":100,"2014M06":101,"2014M07":102,"2014M08":103,"2014M09":104,"2014M10":105,"2014M11":106,"2014M12":107,"2015M01":108,"2015M02":109,"2015M03":110,"2015M04":111,"2015M05":112,"2015M06":113,"2015M07":114,"2015M08":115,"2015M09":116,"2015M10":117,"2015M11":118,"2015M12":119,"2016M01":120,"2016M02":121,"2016M03":122,"2016M04":123,"2016M05":124,"2016M06":125,"2016M07":126,"2016M08":127,"2016M09":128,"2016M10":129,"2016M11":130,"2016M12":131,"2017M01":132,"2017M02":133,"2017M03":134,"2017M04":135,"2017M05":136,"2017M06":137,"2017M07":138,"2017M08":139,"2017M09":140,"2017M10":141,"2017M11":142,"2017M12":143,"2018M01":144,"2018M02":145,"2018M03":146,"2018M04":147,"2018M05":148,"2018M06":149,"2018M07":150,"2018M08":151,"2018M09":152,"2018M10":153,"2018M11":154,"2018M12":155,"2019M01":156,"2019M02":157,"2019M03":158,"2019M04":159,"2019M05":160,"2019M06":161,"2019M07":162,"2019M08":163,"2019M09":164,"2019M10":165,"2019M11":166,"2019M12":167,"2020M01":168,"2020M02":169,"2020M03":170,"2020M04":171,"2020M05":172,"2020M06":173,"2020M07":174,"2020M08":175,"2020M09":176,"2020M10":177,"2020M11":178,"2020M12":179,"2021M01":180,"2021M02":181,"2021M03":182,"2021M04":183,"2021M05":184,"2021M06":185,"2021M07":186,"2021M08":187,"2021M09":188,"2021M10":189,"2021M11":190,"2021M12":191,"2022M01":192,"2022M02":193,"2022M03":194,"2022M04":195,"2022M05":196,"2022M06":197,"2022M07":198,"2022M08":199,"2022M09":200,"2022M10":201,"2022M11":202,"2022M12":203,"2023M01":204,"2023M02":205,"2023M03":206,"2023M04":207,"2023M05":208,"2023M06":209,"2023M07":210,"2023M08":211,"2023M09":212,"2023M10":213,"2023M11":214,"2023M12":215,"2024M01":216,"2024M02":217,"2024M03":218,"2024M04":219,"2024M05":220,"2024M06":221,"2024M07":222,"2024M08":223,"2024M09":224},"label":{"2006M01":"2006M01","2006M02":"2006M02","2006M03":"2006M03","2006M04":"2006M04","2006M05":"2006M05","2006M06":"2006M06","2006M07":"2006M07","2006M08":"2006M08","2006M09":"2006M09","2006M10":"2006M10","2006M11":"2006M11","2006M12":"2006M12","2007M01":"2007M01","2007M02":"2007M02","2007M03":"2007M03","2007M04":"2007M04","2007M05":"2007M05","2007M06":"2007M06","2007M07":"2007M07","2007M08":"2007M08","2007M09":"2007M09","2007M10":"2007M10","2007M11":"2007M11","2007M12":"2007M12","2008M01":"2008M01","2008M02":"2008M02","2008M03":"2008M03","2008M04":"2008M04","2008M05":"2008M05","2008M06":"2008M06","2008M07":"2008M07","2008M08":"2008M08","2008M09":"2008M09","2008M10":"2008M10","2008M11":"2008M11","2008M12":"2008M12","2009M01":"2009M01","2009M02":"2009M02","2009M03":"2009M03","2009M04":"2009M04","2009M05":"2009M05","2009M06":"2009M06","2009M07":"2009M07","2009M08":"2009M08","2009M09":"2009M09","2009M10":"2009M10","2009M11":"2009M11","2009M12":"2009M12","2010M01":"2010M01","2010M02":"2010M02","2010M03":"2010M03","2010M04":"2010M04","2010M05":"2010M05","2010M06":"2010M06","2010M07":"2010M07","2010M08":"2010M08","2010M09":"2010M09","2010M10":"2010M10","2010M11":"2010M11","2010M12":"2010M12","2011M01":"2011M01","2011M02":"2011M02","2011M03":"2011M03","2011M04":"2011M04","2011M05":"2011M05","2011M06":"2011M06","2011M07":"2011M07","2011M08":"2011M08","2011M09":"2011M09","2011M10":"2011M10","2011M11":"2011M11","2011M12":"2011M12","2012M01":"2012M01","2012M02":"2012M02","2012M03":"2012M03","2012M04":"2012M04","2012M05":"2012M05","2012M06":"2012M06","2012M07":"2012M07","2012M08":"2012M08","2012M09":"2012M09","2012M10":"2012M10","2012M11":"2012M11","2012M12":"2012M12","2013M01":"2013M01","2013M02":"2013M02","2013M03":"2013M03","2013M04":"2013M04","2013M05":"2013M05","2013M06":"2013M06","2013M07":"2013M07","2013M08":"2013M08","2013M09":"2013M09","2013M10":"2013M10","2013M11":"2013M11","2013M12":"2013M12","2014M01":"2014M01","2014M02":"2014M02","2014M03":"2014M03","2014M04":"2014M04","2014M05":"2014M05","2014M06":"2014M06","2014M07":"2014M07","2014M08":"2014M08","2014M09":"2014M09","2014M10":"2014M10","2014M11":"2014M11","2014M12":"2014M12","2015M01":"2015M01","2015M02":"2015M02","2015M03":"2015M03","2015M04":"2015M04","2015M05":"2015M05","2015M06":"2015M06","2015M07":"2015M07","2015M08":"2015M08","2015M09":"2015M09","2015M10":"2015M10","2015M11":"2015M11","2015M12":"2015M12","2016M01":"2016M01","2016M02":"2016M02","2016M03":"2016M03","2016M04":"2016M04","2016M05":"2016M05","2016M06":"2016M06","2016M07":"2016M07","2016M08":"2016M08","2016M09":"2016M09","2016M10":"2016M10","2016M11":"2016M11","2016M12":"2016M12","2017M01":"2017M01","2017M02":"2017M02","2017M03":"2017M03","2017M04":"2017M04","2017M05":"2017M05","2017M06":"2017M06","2017M07":"2017M07","2017M08":"2017M08","2017M09":"2017M09","2017M10":"2017M10","2017M11":"2017M11","2017M12":"2017M12","2018M01":"2018M01","2018M02":"2018M02","2018M03":"2018M03","2018M04":"2018M04","2018M05":"2018M05","2018M06":"2018M06","2018M07":"2018M07","2018M08":"2018M08","2018M09":"2018M09","2018M10":"2018M10","2018M11":"2018M11","2018M12":"2018M12","2019M01":"2019M01","2019M02":"2019M02","2019M03":"2019M03","2019M04":"2019M04","2019M05":"2019M05","2019M06":"2019M06","2019M07":"2019M07","2019M08":"2019M08","2019M09":"2019M09","2019M10":"2019M10","2019M11":"2019M11","2019M12":"2019M12","2020M01":"2020M01","2020M02":"2020M02","2020M03":"2020M03","2020M04":"2020M04","2020M05":"2020M05","2020M06":"2020M06","2020M07":"2020M07","2020M08":"2020M08","2020M09":"2020M09","2020M10":"2020M10","2020M11":"2020M11","2020M12":"2020M12","2021M01":"2021M01","2021M02":"2021M02","2021M03":"2021M03","2021M04":"2021M04","2021M05":"2021M05","2021M06":"2021M06","2021M07":"2021M07","2021M08":"2021M08","2021M09":"2021M09","2021M10":"2021M10","2021M11":"2021M11","2021M12":"2021M12","2022M01":"2022M01","2022M02":"2022M02","2022M03":"2022M03","2022M04":"2022M04","2022M05":"2022M05","2022M06":"2022M06","2022M07":"2022M07","2022M08":"2022M08","2022M09":"2022M09","2022M10":"2022M10","2022M11":"2022M11","2022M12":"2022M12","2023M01":"2023M01","2023M02":"2023M02","2023M03":"2023M03","2023M04":"2023M04","2023M05":"2023M05","2023M06":"2023M06","2023M07":"2023M07","2023M08":"2023M08","2023M09":"2023M09","2023M10":"2023M10","2023M11":"2023M11","2023M12":"2023M12","2024M01":"2024M01","2024M02":"2024M02","2024M03":"2024M03","2024M04":"2024M04","2024M05":"2024M05","2024M06":"2024M06","2024M07":"2024M07","2024M08":"2024M08","2024M09":"2024M09"}}},"PLAČE":{"extension":{"show":"value"},"label":"PLAČE","category":{"index":{"2":0},"label":{"2":"Neto plača"}}}},"value":[751.93,742.18,759.4,745.77,762.13,760.62,755.31,771.25,764.58,777.4,868.78,818.94,815.68,792.97,815.34,807.86,822.34,817.15,822.68,833.08,820.47,846.38,945.34,870.7,864.43,864.5,878.73,879.19,882.94,883.58,890.24,909.12,905.13,917.64,981.58,938.66,917.15,898.74,921.69,920.67,917.56,924.64,922.14,918.28,929.36,935.11,999.49,957.14,936.77,930.01,967.32,960.02,956.55,965.71,960.14,964.55,963.84,964.48,1041.19,988.96,971.83,969.92,987.03,975.98,982.99,985.95,974.91,988.45,978.2,979.53,1053.96,999.33,993.53,988.47,995.2,987.67,996.62,978.99,976.81,985.55,972.73,986.81,1035.01,1000.21,998.18,982.68,993.7,993.16,997.13,982.72,990.88,989.52,983.3,999.99,1044.89,1007.65,1009.22,997.6,1000.38,1004.44,1004.14,999.16,1006.18,996.39,997.74,1010.66,1057.26,1022.14,1006.91,993.3,1011.58,1008.98,1000.44,1006.71,1008,998.7,997.77,1007.28,1082.34,1035.58,1015.85,1022.32,1033.95,1021.74,1016.36,1018.7,1010.78,1023.28,1015.33,1020.4,1087.08,1074.27,1039.12,1034.2,1055.85,1038.05,1050.78,1045.06,1039.55,1051.73,1047.14,1056.47,1151.76,1129.76,1077.73,1066.33,1083,1078.95,1077.77,1073.47,1071.76,1082.88,1062.03,1086.8,1186.25,1162.67,1115.98,1108.1,1128.15,1114.98,1113.88,1107.96,1119.08,1114.16,1105.26,1122.4,1234.75,1214.93,1172.56,1169.91,1146.11,1266.13,1244.44,1175.47,1176.25,1177.88,1169.52,1181.35,1327.7,1314.62,1269.18,1253.71,1290.97,1278.89,1286.61,1256.24,1249.88,1228.05,1210.46,1218.4,1363.86,1336.82,1236.33,1240.35,1306.68,1304.32,1297.39,1307.61,1304.01,1312.06,1295.01,1317.6,1479.56,1419.56,1399.03,1391.65,1423.75,1417.69,1434.45,1431.61,1428.46,1441.96,1413.16,1434.45,1594.13,1529.86,1477.34,1449.19,1480.9,1487.66,1486.88,1501.97,1508.84,1495.23,1487.43],"role":{"time":["MESEC"]},"version":"2.0","extension":{"px":{"decimals":2}}}'
        json_load = json.loads(json_data)
        death_rate = AveragePay(json_load, RequestType.BIRTH_RATE, "metric_key", 200)
        self.method_name1(death_rate)

    def method_name1(self, response_init):
        result = response_init.parse()
        self.assertEqual(len(result.data_units), len(result.databox_units))
        self.assertEqual(result.data_type, RequestType.BIRTH_RATE)
        for idx, unit in enumerate(result.data_units):
            unit_databox = result.databox_units[idx]
            self.assertEqual(unit.value, unit_databox.value)
            self.assertEqual(unit.date, unit_databox.var_date)


if __name__ == '__main__':
    unittest.main()
